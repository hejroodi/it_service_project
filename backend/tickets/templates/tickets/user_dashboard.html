{% extends 'tickets/dashboard_base.html' %}
{% block title %}پنل کاربر{% endblock %}

{% block content %}
{{ block.super }}

<!-- فقط بخش درخواست‌های من (اطلاعات کاربری و دکمه ثبت درخواست جدید قبلاً در dashboard_base هست) -->
<div class="card p-3 shadow-sm mt-4">
    <h5 class="fw-bold mb-3">درخواست‌های من</h5>
    <div id="tickets-table">
        {% include 'tickets/_user_table.html' %}
    </div>
</div>

<script>
function refreshUserTable(){
    fetch("{% url 'user_dashboard_table' %}")
    .then(response => response.json())
    .then(data => {
        document.getElementById("tickets-table").innerHTML = data.html;
    });
}
setInterval(refreshUserTable, 60000); // هر 60 ثانیه آپدیت جدول
</script>
{% endblock %}