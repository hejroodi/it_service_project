<table class="table table-striped table-bordered">
    <thead>
        <tr>
            <th>Ø¹Ù†ÙˆØ§Ù†</th>
            <th>Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒØ¯Ù‡Ù†Ø¯Ù‡</th>
            <th>Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙ…Ø§Ø³</th>
            <th>ÙˆØ§Ø­Ø¯</th>
            <th>Ù†ÙˆØ¹ Ø®Ø¯Ù…Øª</th>
            <th>ØªÙˆØ¶ÛŒØ­Ø§Øª</th>
            <th>ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª</th>
            <th>ÙˆØ¶Ø¹ÛŒØª</th>
            <th>Ø§Ù‚Ø¯Ø§Ù…</th>
        </tr>
    </thead>
    <tbody>
    {% for t in tickets %}
    <tr>
        <!-- Ø¹Ù†ÙˆØ§Ù† -->
        <td style="{% if t.status == 'done' %}background-color: rgba(40, 167, 69, 0.15);
                    {% elif t.status == 'in_progress' %}background-color: rgba(220, 53, 69, 0.15);
                    {% else %}background-color: rgba(23, 162, 184, 0.15);{% endif %}">
            {{ t.title }}
        </td>

        <!-- Ù†Ø§Ù… Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒØ¯Ù‡Ù†Ø¯Ù‡ -->
        <td style="{% if t.status == 'done' %}background-color: rgba(40, 167, 69, 0.15);
                    {% elif t.status == 'in_progress' %}background-color: rgba(220, 53, 69, 0.15);
                    {% else %}background-color: rgba(23, 162, 184, 0.15);{% endif %}">
            {{ t.requester.get_full_name }}
        </td>

        <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªÙ…Ø§Ø³ -->
        <td style="{% if t.status == 'done' %}background-color: rgba(40, 167, 69, 0.15);
                    {% elif t.status == 'in_progress' %}background-color: rgba(220, 53, 69, 0.15);
                    {% else %}background-color: rgba(23, 162, 184, 0.15);{% endif %}">
            ğŸ“ {{ t.requester.phone_number|default:"-" }}<br>
            ğŸ¢ {{ t.requester.room_number|default:"-" }}
        </td>

        <!-- ÙˆØ§Ø­Ø¯ -->
        <td style="{% if t.status == 'done' %}background-color: rgba(40, 167, 69, 0.15);
                    {% elif t.status == 'in_progress' %}background-color: rgba(220, 53, 69, 0.15);
                    {% else %}background-color: rgba(23, 162, 184, 0.15);{% endif %}">
            {{ t.requester.unit.name }}
        </td>

        <!-- Ù†ÙˆØ¹ Ø®Ø¯Ù…Øª -->
        <td style="{% if t.status == 'done' %}background-color: rgba(40, 167, 69, 0.15);
                    {% elif t.status == 'in_progress' %}background-color: rgba(220, 53, 69, 0.15);
                    {% else %}background-color: rgba(23, 162, 184, 0.15);{% endif %}">
            {{ t.service_type.name }}
        </td>

        <!-- ØªÙˆØ¶ÛŒØ­Ø§Øª -->
        <td style="{% if t.status == 'done' %}background-color: rgba(40, 167, 69, 0.15);
                    {% elif t.status == 'in_progress' %}background-color: rgba(220, 53, 69, 0.15);
                    {% else %}background-color: rgba(23, 162, 184, 0.15);{% endif %}">
            {{ t.description }}
        </td>

        <!-- ØªØ§Ø±ÛŒØ® Ø«Ø¨Øª -->
        <td style="{% if t.status == 'done' %}background-color: rgba(40, 167, 69, 0.15);
                    {% elif t.status == 'in_progress' %}background-color: rgba(220, 53, 69, 0.15);
                    {% else %}background-color: rgba(23, 162, 184, 0.15);{% endif %}">
            {{ t.created_at|date:"Y-m-d H:i" }}
        </td>

        <!-- ÙˆØ¶Ø¹ÛŒØª -->
        <td style="{% if t.status == 'done' %}background-color: rgba(40, 167, 69, 0.15);
                    {% elif t.status == 'in_progress' %}background-color: rgba(220, 53, 69, 0.15);
                    {% else %}background-color: rgba(23, 162, 184, 0.15);{% endif %}">
            {{ t.get_status_display }}
        </td>

        <!-- Ø§Ù‚Ø¯Ø§Ù… -->
        <td>
            {% if t.status != 'done' %}
                <form method="post" action="{% url 'mark_done' t.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-success btn-sm me-1">Ø§ØªÙ…Ø§Ù… Ú©Ø§Ø±</button>
                </form>
                <form method="post" action="{% url 'return_to_manager' t.id %}" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-warning btn-sm me-1">Ø¨Ø±Ú¯Ø±Ø¯Ø§Ù†Ø¯Ù† Ø¨Ù‡ Ù…Ø¯ÛŒØ±</button>
                </form>
            {% else %}
                Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡
            {% endif %}

            <!-- Ú¯ÙØªâ€ŒÙˆÚ¯Ùˆ Ø¨Ø§ Ú†Ø´Ù…Ú© Ø§Ú¯Ø± Ù¾ÛŒØ§Ù… Ø®ÙˆØ§Ù†Ø¯Ù‡â€ŒÙ†Ø´Ø¯Ù‡ -->
            {% if t.has_unread %}
                <a href="{% url 'ticket_messages' t.id %}" class="btn btn-sm btn-outline-info mt-1 blink">Ú¯ÙØªÚ¯Ùˆ</a>
            {% else %}
                <a href="{% url 'ticket_messages' t.id %}" class="btn btn-sm btn-outline-info mt-1">Ú¯ÙØªÚ¯Ùˆ</a>
            {% endif %}
        </td>
    </tr>
    {% empty %}
    <tr><td colspan="9" class="text-center">Ù‡ÛŒÚ† Ù…ÙˆØ±Ø¯ÛŒ Ù†ÛŒØ³Øª</td></tr>
    {% endfor %}
    </tbody>
</table>